(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-main-myservice-console"],{"1da6":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"pagecontent"},[t.show_apploading?[i("v-uni-view",{staticClass:"loadingpage"},[i("v-uni-view",{staticClass:"loadingtop"},[i("v-uni-image",{staticClass:"loadingphoto",attrs:{mode:"aspectFill",src:"/static/images/logo.png"}})],1),i("v-uni-view",{staticClass:"loadingtext",staticStyle:{"margin-top":"10vh"}},[t._v("哈工大电脑义诊")]),t.show_loadingerr?i("v-uni-view",{staticStyle:{"margin-top":"5vh"}},[i("v-uni-text",{staticClass:"loadingtip"},[t._v(t._s(t.show_loadingerr))])],1):i("v-uni-view",{staticStyle:{"margin-top":"5vh"}},[i("v-uni-image",{staticClass:"loadingicon",attrs:{mode:"aspectFill",src:"/static/images/LOADING.gif"}})],1)],1)]:[t.VolListModel?i("v-uni-view",{staticClass:"MODEL"},[i("v-uni-view",{staticClass:"MODELchild",staticStyle:{"background-color":"black"}},[i("v-uni-view",{staticClass:"MODELtitle"},[i("v-uni-text",{staticStyle:{color:"white !important"}},[t._v("审核志愿时长申请")])],1),t.Vollist.length>0?[i("v-uni-scroll-view",{staticStyle:{"max-height":"70vh"},attrs:{"scroll-y":!0}},[i("v-uni-view",{staticClass:"TABLE2",staticStyle:{padding:"0"}},[i("v-uni-view",{staticClass:"FORMitem FORMline",style:"width:500rpx;background-color:#383838;color:white !important;justify-content:space-between;padding-left:8rpx;padding-right:8rpx;margin-bottom:0px"},[i("v-uni-view",{staticClass:"TABLE2block",staticStyle:{color:"white !important"}},[t._v("提交时间")]),i("v-uni-view",{staticClass:"TABLE2block",staticStyle:{color:"white !important"}},[t._v("申请时长 / 姓名")])],1),t._l(t.Vollist,(function(e,o){return i("v-uni-view",{key:e.value},[i("v-uni-view",{staticClass:"FORMitem FORMline",style:"width:500rpx;background-color:"+(t.VolChoose==o?"white":o%2==0?"#111111":"#383838")+";justify-content:space-between;padding-left:8rpx;padding-right:8rpx;margin-top:2px;margin-bottom:0px",attrs:{"data-id":"choose"+o},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.volDeal.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"TABLE2block tabletext",style:"color:"+(t.VolChoose==o?"black":"white")+" !important"},[t._v(t._s(e.time))]),i("v-uni-view",{staticClass:"TABLE2block tabletext",style:"color:"+(t.VolChoose==o?"black":"white")+" !important"},[t._v(t._s("( "+e.applyTime+"h ) "+e.info.person.name))])],1)],1)}))],2)],1)]:[i("v-uni-view",{staticClass:"MODELblock"},[i("v-uni-text",{staticClass:"FORMtextline",staticStyle:{color:"white"}},[t._v("暂无申请记录")])],1)],i("v-uni-view",{staticClass:"MODELrow"},[i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{width:"600rpx !important","background-color":"gray",color:"white"},attrs:{"data-id":"confirm"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.volDeal.apply(void 0,arguments)}}},[t._v("全部通过并生成申请表")])],1),i("v-uni-view",{staticClass:"MODELrow"},[i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{"background-color":"gray",color:"white"},attrs:{"data-id":"cancel"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.volDeal.apply(void 0,arguments)}}},[t._v("关闭")]),i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{"background-color":"gray",color:"white"},attrs:{"data-id":"back"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.volDeal.apply(void 0,arguments)}}},[t._v("退回选中")])],1)],2)],1):t._e(),t.ACTchooseModel?i("v-uni-view",{staticClass:"MODEL"},[i("v-uni-view",{staticClass:"MODELchild",staticStyle:{"background-color":"black"}},[i("v-uni-view",{staticClass:"MODELtitle"},[i("v-uni-text",{staticStyle:{color:"white"}},[t._v("选择"+t._s(t.ACTModelMode?"义诊活动":"日期"))])],1),t.ACTlist.length>0?[i("v-uni-scroll-view",{staticStyle:{"font-size":"30rpx","max-height":"70vh"},attrs:{"scroll-y":!0}},[i("v-uni-view",{staticClass:"TABLE2",staticStyle:{padding:"0"}},[i("v-uni-view",{staticClass:"FORMitem FORMline",style:"width:500rpx;background-color:#383838;color:white;justify-content:space-between;padding-left:8rpx;padding-right:8rpx;margin-bottom:0px"},[i("v-uni-view",{staticClass:"TABLE2block"},[t._v("时间")]),i("v-uni-view",{staticClass:"TABLE2block"},[t._v(t._s(t.ACTModelMode?"创建者":"预约数"))])],1),t._l(t.ACTlist,(function(e,o){return i("v-uni-view",{key:e.value},[i("v-uni-view",{staticClass:"FORMitem FORMline",style:"width:500rpx;background-color:"+(t.ACTchooseindex==o?"white":o%2==0?"#111111":"#383838")+";justify-content:space-between;padding-left:8rpx;padding-right:8rpx;margin-top:4rpx;margin-bottom:0px",attrs:{"data-id":"choose"+o},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ACTmodel.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"TABLE2block tabletext",style:"color:"+(t.ACTchooseindex==o?"black":"white")+" !important"},[t._v(t._s(e.time))]),i("v-uni-view",{staticClass:"TABLE2block tabletext",style:"color:"+(t.ACTchooseindex==o?"black":"white")+" !important"},[t._v(t._s(t.ACTModelMode?e.creater:e.count))])],1)],1)}))],2)],1)]:[i("v-uni-view",{staticClass:"MODELblock"},[i("v-uni-text",{staticClass:"FORMtextline",staticStyle:{color:"white"}},[t._v("暂无历史记录")])],1)],i("v-uni-view",{staticClass:"MODELrow"},[i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{"background-color":"gray",color:"white"},attrs:{"data-id":"confirm"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ACTmodel.apply(void 0,arguments)}}},[t._v("选择")]),i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{"background-color":"gray",color:"white"},attrs:{"data-id":"hide"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ACTmodel.apply(void 0,arguments)}}},[t._v("关闭")])],1)],2)],1):t._e(),t.OpLoginModel?i("v-uni-view",{staticClass:"MODEL"},[i("v-uni-view",{staticClass:"MODELchild",staticStyle:{"background-color":"black"}},[i("v-uni-view",{staticClass:"MODELtitle"},[i("v-uni-text",{staticStyle:{color:"white"}},[t._v("义诊操作人员登录")])],1),i("v-uni-view",{staticClass:"FORMitem FORMline"},[i("v-uni-view",{staticClass:"FORMlineleft",staticStyle:{color:"white"}},[t._v("学工号")]),i("v-uni-view",{staticClass:"FORMlineright"},[i("v-uni-input",{staticClass:"MODELinput",staticStyle:{width:"375rpx",color:"white","background-color":"gray"},attrs:{placeholder:"请输入学工号","placeholder-class":"inputboxplaceholder",maxlength:"-1","data-id":"stuid",value:t.OpLoginData.stuid,"auto-focus":!0},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.editLogin.apply(void 0,arguments)}}})],1)],1),i("v-uni-view",{staticClass:"FORMitem FORMline"},[i("v-uni-view",{staticClass:"FORMlineleft",staticStyle:{color:"white"}},[t._v("姓名")]),i("v-uni-view",{staticClass:"FORMlineright"},[i("v-uni-input",{staticClass:"MODELinput",staticStyle:{width:"375rpx",color:"white","background-color":"gray"},attrs:{placeholder:"请输入姓名","placeholder-class":"inputboxplaceholder",maxlength:"-1","data-id":"name",value:t.OpLoginData.name},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.editLogin.apply(void 0,arguments)}}})],1)],1),i("v-uni-view",{staticClass:"MODELrow"},[i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{"background-color":"gray",color:"white"},attrs:{"data-id":"save"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.OpModelBtn.apply(void 0,arguments)}}},[t._v("登录")]),i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{"background-color":"gray",color:"white"},attrs:{"data-id":"cancel"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.OpModelBtn.apply(void 0,arguments)}}},[t._v("取消")])],1)],1)],1):t._e(),t.SuperOpModel?i("v-uni-view",{staticClass:"MODEL"},[i("v-uni-view",{staticClass:"MODELchild",staticStyle:{"background-color":"black"}},[i("v-uni-view",{staticClass:"MODELtitle"},[i("v-uni-text",{staticStyle:{color:"white"}},[t._v("最高管理员权限认证")])],1),i("v-uni-input",{staticClass:"MODELinput",staticStyle:{color:"white","background-color":"gray"},attrs:{maxlength:"-1","data-id":"pass","auto-focus":!0,placeholder:"输入最高管理员密码","placeholder-style":"color: #AAAAAA"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.superOp.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"MODELrow"},[i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{"background-color":"gray",color:"white"},attrs:{"data-id":"confirm"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.superOp.apply(void 0,arguments)}}},[t._v("确认")]),i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{"background-color":"gray",color:"white"},attrs:{"data-id":"cancel"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.superOp.apply(void 0,arguments)}}},[t._v("取消")])],1)],1)],1):t._e(),t.ChangeServiceTipModel?i("v-uni-view",{staticClass:"MODEL"},[i("v-uni-view",{staticClass:"MODELchild",staticStyle:{"background-color":"black"}},[i("v-uni-view",{staticClass:"MODELtitle"},[i("v-uni-text",{staticStyle:{color:"white"}},[t._v("修改义诊须知")])],1),i("v-uni-input",{staticClass:"MODELinput",staticStyle:{color:"white","background-color":"gray"},attrs:{maxlength:"-1","auto-focus":!0},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.editRich.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"MODELrow"},[i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{"background-color":"gray",color:"white"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.SAVERICH.apply(void 0,arguments)}}},[t._v("确认")]),i("v-uni-button",{staticClass:"MODELbtn",staticStyle:{"background-color":"gray",color:"white"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.RICH.apply(void 0,arguments)}}},[t._v("取消")])],1)],1)],1):t._e(),i("v-uni-view",{staticClass:"PAGECONTENT"},[i("v-uni-view",{staticClass:"con",staticStyle:{"background-color":"white"}},[t.actId?i("v-uni-text",{staticClass:"title",staticStyle:{"font-weight":"400","font-size":"30rpx"}},[t._v("长按logo签退，如需访问义诊页面，请重新扫描预约者二维码或者进入我的服务点击预约信息或者在查询栏搜索预约ID")]):t._e(),t.actId?i("v-uni-button",{staticStyle:{margin:"15rpx auto"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.scanBookID.apply(void 0,arguments)}}},[t._v("扫描预约二维码")]):t._e(),t._e(),!t.SUPEROP&&t.op_right?[i("v-uni-button",{staticClass:"weui-btn",staticStyle:{margin:"15rpx auto","background-color":"brown",color:"white"},attrs:{type:"warn","data-id":"volapply"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.Btn_SubmitForm.apply(void 0,arguments)}}},[t._v("最高管理员认证")])]:t._e(),t.op_right&&t.SUPEROP?[i("v-uni-button",{staticStyle:{margin:"15rpx auto"},attrs:{"data-id":"get"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.volDeal.apply(void 0,arguments)}}},[t._v("审核志愿申请")])]:t._e(),t.op_right?i("v-uni-button",{staticClass:"weui-btn",staticStyle:{margin:"15rpx auto",color:"black"},attrs:{type:"default","data-id":"tableOld"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.OpModelBtn.apply(void 0,arguments)}}},[t._v("查询历史数据")]):t._e(),t.op_right?i("v-uni-button",{staticClass:"weui-btn",staticStyle:{margin:"15rpx auto",color:"black"},attrs:{type:"default","data-id":"exportData"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.OpModelBtn.apply(void 0,arguments)}}},[t._v("导出义诊数据")]):t._e(),t.op_right?i("v-uni-button",{staticStyle:{margin:"15rpx auto"},attrs:{"data-id":"setDate"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.OpModelBtn.apply(void 0,arguments)}}},[t._v("设置可预约日期")]):t._e(),t.op_right?i("v-uni-button",{staticStyle:{margin:"15rpx auto"},attrs:{"data-id":"cancelDate"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.OpModelBtn.apply(void 0,arguments)}}},[t._v("取消某日义诊/退回预约")]):t._e(),i("v-uni-text",{staticClass:"title"},[t._v(t._s(t.show_title))]),i("v-uni-input",{staticClass:"mainInput",attrs:{placeholder:t.show_inputholder,"placeholder-style":"font-size: 20rpx","placeholder-class":"inputboxplaceholder",value:t.input_id},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.Input_IDChange.apply(void 0,arguments)}}}),i("v-uni-button",{staticStyle:{"margin-top":"30rpx"},attrs:{disabled:t.BtnSubmitDisabled},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.Btn_SubmitForm.apply(void 0,arguments)}}},[t._v(t._s(t.BtnTitle))]),i("v-uni-view",{staticClass:"text2",attrs:{selectable:!0}},[t._v(t._s(t.show_maintext))])],2)],1)]],2)},n=[]},"519d":function(t,e,i){"use strict";var o=i("bbef"),n=i.n(o);n.a},7765:function(t,e,i){"use strict";(function(t){i("7a82");var o=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i("53ca")),a=o(i("ade3"));i("ac1f"),i("466d"),i("4e82"),i("14d9"),i("a434"),i("d401"),i("d3b7"),i("25f0"),i("c975"),i("99af"),i("a9e3"),i("e9c4"),i("5319");var s=i("51b3"),l=i("460c"),c=getApp(),r=c.globalData,u=(r.ENCRYPTO,t.database()),d=u.collection("ProgramSet"),p=(u.collection("Users"),i("d3e5"),!1),h=u.collection("Group"),f=u.collection("Volunteer"),g=!1,v={},m=(c=getApp(),{data:function(){return{AppSet:{POSTOPEN:!0},OPENID:r.openid,UID:r.uid,PAGES:r.PAGES,PAGE:2,show_apploading:!0,Vollist:[],VolListModel:!1,SuperOpModel:!1,ACTchooseModel:!1,ACTModelMode:!0,ACTlist:[],isClubMem:!1,ACTchooseindex:-1,goToTable:!1,op_right:!1,op_commandtext:"可用命令（参数中不能有下划线）\n\n info \n    查看当前服务器状态 \n setopen \n    查看当前服务器开放状态（值为OPEN为开放，否则为关闭，且值为关闭时对用户展示的信息）  \n setservicetip \n    修改义诊须知 \n getbydate_2020-10-25 \n    通过日期获取预约数据 \n setweekday_0~7 \n    设置预约星期几（0为周日）\nsettimestart_数字 \n   设置当日开始时间（从0时开始的分钟数） \nsettimepersec_数字 \n   设置每时段时长（分钟） \nsetpeopersec_数字 \n   设置每时段人数 \nsetsecnum_数字 \n    设置总时段数 \n setnotice_公告文本 \n    设置公告内容 \n setopkey_管理员密码 \n    设置管理员密码 \n setcollection_数据库集合名称 \n    设置当前服务器正在使用的数据库名称\n setenddate_2020-11-01 \n    设置可预约的终止日期 \n cancel_2022-03-12 \n    取消当日义诊，退回所有预约\n quit \n    退出管理员模式",show_inputholder:"请输入管理员密码",show_title:"管理员登录",input_id:"",BtnSubmitDisabled:!1,OpLoginModel:!1,actId:!1,OpLoginData:{stuid:"",name:""},show_maintext:"暂无预约",BookData:[],BtnTitle:"执行",SUPEROP:!1,show_defaultTime:!1,show_forbidTime:!1,cardFold:{default:!0},show_loadingerr:"",VolChoose:"",ChangeServiceTipModel:!1}},onLoad:function(t){r.ServerReady(this.areReady)},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},methods:{goPage:function(t){r.goPage(t,this.$data.PAGE)},volDeal:function(t){var e=t.currentTarget.dataset.id,i=this;if("get"==e){uni.showLoading({title:"加载中",mask:!0});var o=u.command.aggregate;(0,s.cbq)(f.aggregate().match({status:"待审核"}).group({_id:null,v:o.addToSet({_id:"$_id",time:"$time",applyTime:"$applyTime",info:"$info"})}).end(),{success:function(t){if(console.log(t),uni.hideLoading({success:function(t){}}),t.data.length>0){var e=l.sort(t.data[0].v,"time",!0,!1);i.setData({Vollist:e,VolListModel:!0,VolChoose:-1})}else uni.showToast({title:"无记录"})},fail:function(t){console.log(t),uni.showToast({title:"错误",icon:"error"})}})}else if("confirm"==e){uni.showLoading({title:"加载中"});var n=i.Vollist,a=[];for(var c in n)a.push(n[c]._id);console.log(a);var d=u.command;(0,s.cbq)(f.where({_id:d.in(a)}).update({status:"已通过"}),{success:function(t){uni.hideLoading({success:function(t){}}),console.log(t),i.csvFileGenerate("vol",{userRes:i.Vollist,actInfo:{name:"HIT电脑110俱乐部电脑义诊",location:"一区活动中心418",person:r.OpData.name,company:"HIT电脑110俱乐部",intro:r.AppSet.VolActIntro}}),i.setData({VolListModel:!1})},fail:function(t){console.log(t),uni.showToast({title:"错误",icon:"error"})}})}else if("cancel"==e)i.setData({VolListModel:!1});else if("back"==e){if(-1==this.VolChoose)return void uni.showToast({title:"请选择",icon:"error"});uni.showLoading({title:"加载中",mask:!0}),console.log(this.Vollist[this.VolChoose]);var p=this.Vollist[this.VolChoose];o=u.command.aggregate;(0,s.cbq)(f.doc(p._id).update({applyTimeValid:0,status:"已退回"}),{success:function(t){console.log(t),uni.hideLoading({success:function(t){}});var e=i.Vollist;e.splice(i.VolChoose,1),i.setData({Vollist:e,VolListModel:!0,VolChoose:-1})},fail:function(t){console.log(t),uni.showToast({title:"错误",icon:"error"})}})}else"choose"==e.substr(0,6)&&(console.log(e.substring(6)),i.setData({VolChoose:e.substring(6)}))},superOp:function(t){var e=t.currentTarget.dataset.id;"pass"==e?this.superOpkeytmp=t.detail.value:"confirm"==e?this.superOpkeytmp==r.AppSet.opsuperkey?this.setData({SuperOpModel:!1,SUPEROP:!0}):uni.showToast({title:"密码错误",icon:"error"}):"cancel"==e&&this.setData({SuperOpModel:!1})},ACTmodel:function(t){var e=t.currentTarget.dataset.id;"hide"==e?this.setData({ACTchooseModel:!1,ACTchooseindex:-1}):"confirm"==e?this.ACTModelMode?uni.navigateTo({url:"../optable/optable?TIME="+this.ACTlist[this.ACTchooseindex].time.split(" ")[0]+"&ACTID="+this.ACTlist[this.ACTchooseindex].id}):(uni.showToast({title:"请看命令结果"}),this.setData({input_id:"getbydate_"+this.ACTlist[this.ACTchooseindex].time,ACTchooseModel:!1,ACTchooseindex:-1}),this.Btn_SubmitForm({currentTarget:{dataset:{id:""}}})):"choose"==e.substr(0,6)&&(console.log(this.ACTlist[e.substring(6)].id),this.setData({ACTchooseindex:e.substring(6)}))},editLogin:function(t){this.OpLoginData[t.currentTarget.dataset.id]=t.detail.value},OpModelBtn:function(e){var i=this,o=e.currentTarget.dataset.id,n=u.command,a=n.aggregate;if(console.log(o),"tableOld"!=o)if("setDate"!=o)if("cancelDate"!=o)if("exportData"!=o){if(this.op_right&&"show"==o)uni.showModal({showCancel:!0,title:"提示",content:"你要退出管理员模式吗？",success:function(t){t.confirm&&(i.setData({input_id:"quit",ACTchooseModel:!1,ACTchooseindex:-1}),i.Btn_SubmitForm({currentTarget:{dataset:{id:""}}}))}});else if(!this.op_right||this.goToTable){if("show"==o){if(this.actId)return void uni.showModal({showCancel:!0,title:"提示",content:"你要签退吗？",success:function(e){if(e.confirm){uni.showLoading({title:"正在退出",mask:!0});u.command;(0,s.cbq)(t.callFunction({name:"updatecQuitGroup",data:{doc:i.actId,data:{time:l.getTime(),operator:i.OpLoginData}}}),{success:function(t){uni.setStorage({key:"ACTID",data:""}),i.setData({actId:!1,show_title:"查询我的预约",show_inputholder:"请输入学工号或留空自动查询本账号记录"})},fail:function(t){uni.showModal({showCancel:!1,title:"错误",content:t.errMsg})},complete:function(t){uni.hideLoading({success:function(t){}})}})}}})}else if("cancel"==o)this.goToTable=!1;else if("save"==o){var d=this.OpLoginData;if(console.log(d),this.setData({OpLoginData:this.OpLoginData}),uni.setStorage({data:this.OpLoginData,key:"OPLOGIN"}),this.goToTable)return r.OpData=this.OpLoginData,r.OpData.openid=r.openid,this.goToTable=!1,uni.navigateTo({url:"../optable/optable"}),void this.setData({OpLoginModel:!this.OpLoginModel});if(this.op_right)return;if(!this.OpLoginData.name||!this.OpLoginData.stuid)return void uni.showModal({showCancel:!1,title:"请输入有效信息"});console.log(11),uni.showModal({title:"提示",content:"请选择你要进行的操作\n选择临时处理可处理临时预约\n选择签到登录可以进行义诊活动签到",confirmText:"签到登录",cancelText:"临时处理",success:function(e){e.confirm&&uni.showModal({title:"提示",content:"请扫描部长二维码进行签到",confirmText:"扫描",success:function(e){e.confirm&&uni.scanCode({onlyFromCamera:!1,success:function(e){i.actId=e.result.substr(5),console.log(e.result,i.actId),uni.showLoading({title:"签到中",mask:!0}),i.OpLoginData.openid=r.openid,(0,s.cbq)(h.doc(i.actId).get(),{complete:function(t){uni.hideLoading({success:function(t){}})},success:function(e){console.log(e),e.data[0].ongoing?(uni.showLoading({title:"签到中",mask:!0}),(0,s.cbq)(t.callFunction({name:"updatecJoinGroup",data:{doc:i.actId,data:{hasSignIn:{time:l.getTime(!0,!1),operator:i.OpLoginData},startperson:{time:c.globalData.getTime(),operator:i.OpLoginData}}}}),{success:function(t){uni.setStorage({data:!0,key:"ISCLUBMEMBER"}),uni.showModal({title:"提示",content:"签到成功",showCancel:!1}),r.OpData=i.OpLoginData,r.OpData.openid=r.openid,i.setData({actId:i.actId,show_title:"义诊接单",show_inputholder:"请输入或扫描预约ID",show_maintext:"",BookData:[]}),uni.setStorage({key:"ACTID",data:i.actId}),i.Btn_SubmitForm()},complete:function(t){uni.hideLoading({success:function(t){}})},fail:function(t){var e=t.errMsg;uni.showModal({title:"错误",content:e,showCancel:!1}),i.setData({actId:!1,show_title:"查询我的预约",show_inputholder:"请输入学工号或留空自动查询本账号记录"})}})):(uni.showModal({title:"签到失败",content:"此次义诊活动已结束",showCancel:!1}),i.setData({actId:!1,show_title:"查询我的预约",show_inputholder:"请输入学工号或留空自动查询本账号记录"}))},fail:function(t){var e=t.errMsg;console.log(t.errMsg),t.errMsg.indexOf("cannot find document with")&&(e="未找到此次义诊活动"),uni.showModal({title:"错误",content:e,showCancel:!1}),i.setData({actId:!1,show_title:"查询我的预约",show_inputholder:"请输入学工号或留空自动查询本账号记录"})}})}})}}),e.cancel&&uni.showModal({title:"提示",content:"请扫描临时预约二维码",confirmText:"扫描",success:function(t){t.confirm&&(r.OpData=i.OpLoginData,r.OpData.openid=r.openid,i.scanBookID())}})},fail:console.error()})}console.log(this.OpLoginModel),this.setData({OpLoginModel:!this.OpLoginModel})}}else uni.showModal({title:"确认导出数据",success:function(t){t.confirm&&(uni.showLoading({title:"加载中",mask:!0}),(0,s.cbq)(p.aggregate().addFields({"book.date":a.cond({if:a.eq([a.ifNull(["$book.date","假"]),"假"]),then:"$date",else:"$book.date"})}).sort({"book.date":1}).group({_id:null,val:a.push({_id:"$_id",_openid:"$_openid",book:"$book",comment:"$comment",resolve:"$resolve",hasSubscribe:"$hasSubscribe",status:"$status",statusText:"$statusText",hasCal:"$hasCal",cancelTime:"$cancelTime",defaultTime:"$defaultTime"})}).end(),{success:function(t){var e=t.data,o=e[0].val;console.log(o),i.csvFileGenerate("exp",o)},fail:function(t){console.log(t),uni.showToast({title:"失败",icon:"error"})}}))}});else uni.showModal({title:"取消某日义诊",editable:!0,content:l.getTime(!0,!1),success:function(t){if(t.confirm){if(""==t.content)return void uni.showToast({icon:"error",title:"请输入日期"});uni.showToast({title:"请看命令结果"}),i.setData({input_id:"cancel_"+t.content,ACTchooseModel:!1,ACTchooseindex:-1}),i.Btn_SubmitForm({currentTarget:{dataset:{id:""}}})}}});else uni.showModal({title:"设置预约终止日期",editable:!0,content:l.getTime(!0,!1),success:function(t){t.confirm&&(i.setData({input_id:"setenddate_"+t.content,ACTchooseModel:!1,ACTchooseindex:-1}),i.Btn_SubmitForm({currentTarget:{dataset:{id:""}}}))}});else uni.showModal({cancelText:"按天查询",confirmText:"义诊活动",title:"选择查询模式",success:function(t){t.confirm?(uni.showLoading({title:"加载中",mask:!0}),(0,s.cbq)(h.aggregate().sort({"start.time":-1}).group({_id:"$ongoing",val:a.push({id:"$_id",time:"$start.time",creater:"$start.operator.name"})}).end(),{success:function(t){var e=t.data;console.log(e);var o=null;for(var n in e)"false"==e[n]._id.toString()&&(o=e[n].val);uni.hideLoading({success:function(t){}}),i.setData({ACTModelMode:!0,ACTchooseModel:!0,ACTlist:o})},fail:function(t){console.log(t),uni.showToast({title:"失败",icon:"error"})}})):t.cancel&&(uni.showLoading({title:"加载中",mask:!0}),(0,s.cbq)(p.aggregate().addFields({"book.date":a.cond({if:a.eq([a.ifNull(["$book.date","假"]),"假"]),then:"$date",else:"$book.date"})}).group({_id:"$book.date",count:a.sum(1)}).sort({_id:-1}).group({_id:null,val:a.push({time:"$_id",count:"$count"})}).end(),{success:function(t){var e=t.data;console.log(e);var o=e[0].val;uni.hideLoading({success:function(t){}}),i.setData({ACTModelMode:!1,ACTchooseModel:!0,ACTlist:o})},fail:function(t){console.log(t),uni.showToast({title:"失败",icon:"error"})}}))}})},Input_IDChange:function(t){this.input_id=t.detail.value},Op_Updatelist:function(t,e){var i=t;console.log(i),0==i.length?this.show_maintext="暂无预约":this.show_maintext="点击记录可取消或查看详情",this.setData({show_maintext:this.show_maintext,BookData:this.BookData.concat(i),BtnSubmitDisabled:!1})},getDb:function(t,e){0==e&&(this.BookData=[]);var i=this,o=u.command;(0,s.cbq)(p.where(o.or([(0,a.default)({},"book.date",t),(0,a.default)({},"date",t)])).orderBy("book.uploadtime","asc").skip(20*e).limit(20).get(),{success:function(o){console.log(o);var n=r.dealOldVerBook(o.data);i.Op_Updatelist(n,e),20==n.length&&i.getDb(t,e+1)}})},goMyService:function(t){uni.navigateTo({url:"../myservice/myservice"})},goPaiHang:function(t){uni.navigateTo({url:"../myservice/myservice?ONLYPAIHANG=true"})},editRich:function(t){this.rich=t.detail.value},SAVERICH:function(t){var e=this;this.setData({ChangeServiceTipModel:!1}),(0,s.cbq)(d.doc("init").update({ServiceTip:this.rich}),{complete:console.log,fail:e.failset,success:function(t){e.setData({show_maintext:"义诊须知更改成功\n\n"+e.op_commandtext})}})},RICH:function(t){!0===t?this.setData({ChangeServiceTipModel:!0}):this.setData({ChangeServiceTipModel:!1})},NoSuperOp:function(t){return!this.SUPEROP&&(uni.showToast({title:"无最高权限",icon:"error"}),!0)},showID:function(t){uni.showModal({title:"获取OPENID",content:"OPENID可用于APP登录，请不要将OPENID告诉他人\n"+t,confirmText:"复制ID",success:function(e){e.confirm&&uni.setClipboardData({data:t})}})},Op_GetAllRequest:function(t){var e=this,i=t.split("_");if(console.log(i),"info"!=i[0])if("setopen"!=i[0])if("getbydate"!=i[0])if("setnotice"!=i[0])if("setopkey"!=i[0])if("setcollection"!=i[0])if("cancel"!=i[0])if("setenddate"!=i[0])if("quit"!=i[0])if("setservicetip"!=i[0]){for(var o=d.doc("init"),n=[{id:"setsecnum",content:"AllSecTime",tip:"更改总时段数成功"},{id:"setpeopersec",content:"PeoPerSec",tip:"更改时段人数成功"},{id:"settimepersec",content:"TimePerSec",tip:"更改总时段数成功"},{id:"settimestart",content:"TimeStart",tip:"更改开始时间成功"},{id:"setweekday",content:"WeekDay",tip:"更改预约星期几成功"}],l=0;l<n.length;l++)if(i[0]==n[l].id)return void(0,s.cbq)(o.update((0,a.default)({},n[l].content,Number(i[1]))),{complete:console.log,fail:e.failset,success:function(t){e.setData({show_maintext:n[l].tip+"\n\n"+e.op_commandtext})}});this.setData({show_maintext:"命令不正确\n\n"+this.op_commandtext})}else{if(e.NoSuperOp())return;this.RICH(!0)}else this.setData({SUPEROP:!1,op_right:!1,show_title:"查询我的预约",show_inputholder:"请输入学工号或留空自动查询本账号记录",input_id:"",show_maintext:"暂无预约"});else(0,s.cbq)(d.doc("init").update({enddate:i[1]}),{complete:console.log,fail:e.failset,success:function(t){e.setData({show_maintext:"（切换页面后生效）可预约终止日期成功更改为："+i[1]+"\n\n"+e.op_commandtext})}});else{if(e.NoSuperOp())return;uni.showModal({title:"确认取消义诊",content:"将退回"+i[1]+"所有预约",success:function(t){t.confirm&&(uni.showLoading({title:"加载中",mask:!0}),r.sendCancel(i[1],!0))}})}else{if(e.NoSuperOp())return;(0,s.cbq)(d.doc("init").update({ColName2:i[1]}),{complete:console.log,fail:e.failset,success:function(t){e.setData({show_maintext:"（切换页面后生效）数据库集合成功更改为："+i[1]+"\n\n"+e.op_commandtext})}})}else{if(e.NoSuperOp())return;(0,s.cbq)(d.doc("init").update({opkey:i[1]}),{complete:console.log,fail:e.failset,success:function(t){e.setData({show_maintext:"（切换页面后生效）管理员密码成功更改为："+i[1]+"\n\n"+e.op_commandtext})}})}else{if(e.NoSuperOp())return;(0,s.cbq)(d.doc("init").update({notice:i[1]}),{complete:console.log,fail:e.failset,success:function(t){e.setData({show_maintext:"（切换页面后生效）公告成功更改为："+i[1]+"\n\n"+e.op_commandtext})}})}else this.getDb(i[1],0);else{if(e.NoSuperOp())return;(0,s.cbq)(d.doc("init").update({OPEN:i[1]}),{complete:console.log,fail:e.failset,success:function(t){e.setData({show_maintext:"（切换页面后生效）开放状态成功更改为："+i[1]+"\n\n"+e.op_commandtext})}})}else e.setData({show_maintext:"当前服务器信息：(可能需要重新进入页面进行更新)\n开放状态/停止服务信息："+v.OPEN+"\n预约当天开始时间："+v.TimeStart+" 分钟\n总时段数："+v.AllSecTime+" 个\n时段时长："+v.TimePerSec+" 分钟\n时段人数："+v.PeoPerSec+" 人\n预约星期几："+v.WeekDay+"\n目前可预约的终止日期："+v.enddate+" \n\n"+e.op_commandtext})},failset:function(t){this.setData({show_maintext:"错误："+t.errMsg+"\n\n"+this.op_commandtext})},scanBookID:function(t){uni.scanCode({onlyFromCamera:!1,success:function(t){console.log(t.result),uni.navigateTo({url:"../bookinfo/bookinfo?id="+t.result+"&reop=true"})}})},Btn_SubmitForm:function(t){var e=this,i=u.command,o=i.aggregate;if(this.actId){var n=this.input_id;(0,s.cbq)(p.aggregate().match((0,a.default)({},"_id",{$regex:".*"+n+".*",$options:"1"})).addFields({"book.date":o.cond({if:o.eq([o.ifNull(["$book.date","假"]),"假"]),then:"$date",else:"$book.date"})}).match({"book.date":i.neq("请选择预约义诊日期")}).sort({"book.date":-1,"book.uploadtime":-1}).limit(50).end(),{success:function(t){var i=r.dealOldVerBook(t.data);0==i.length?e.show_maintext="暂无预约":e.show_maintext="点击记录可取消或查看详情",e.setData({show_maintext:e.show_maintext,BookData:i,BtnSubmitDisabled:!1})},fail:function(t){console.error(t),e.setData({show_maintext:t.errMsg})}})}else{if(this.input_id!=g)return this.op_right?"table"==t.currentTarget.dataset.id?void this.setData({goToTable:!0,OpLoginModel:!0}):"volapply"==t.currentTarget.dataset.id?r.OpData&&r.OpData.name?void this.setData({SuperOpModel:!0}):void uni.showToast({title:"请先登录",icon:"error"}):void this.Op_GetAllRequest(this.input_id):void 0;this.setData({op_right:!0,show_title:"管理员模式",show_inputholder:"command_content",input_id:"",show_maintext:this.op_commandtext,BookData:[]})}},switchAd:function(e){if(""!=r.openid){var i=this,o=e.detail.value,n=t.database().collection("Users");(0,s.cbq)(n.where({_openid:r.openid}).update({ad:o}),{success:function(t){r.USERINFO.ad=o,i.setData({AD:o}),uni.showToast({title:"设置成功"})},fail:function(t){uni.showToast({title:"设置失败",icon:"error"}),i.setData({AD:!0})}})}},BookDetail:function(t){uni.navigateTo({url:"../bookinfo/bookinfo?id="+t.currentTarget.dataset.id+"&op="+(this.op_right?"true":"false")+"&reop="+(this.actId?"true":"false")})},RecoverAct:function(){var t=this;uni.getStorage({key:"ACTID",success:function(e){if(e.data){var i=e.data;uni.showModal({title:"义诊中断",content:"上次义诊活动尚未签退，是否恢复？",success:function(e){e.confirm?(console.log(i),t.actId=i,uni.showLoading({title:"恢复中",mask:!0}),(0,s.cbq)(h.doc(t.actId).get(),{complete:function(t){uni.hideLoading({success:function(t){}})},success:function(e){e.data[0].ongoing?(r.OpData=t.OpLoginData,r.OpData.openid=r.openid,t.setData({actId:t.actId,show_title:"义诊接单",show_inputholder:"请输入或扫描预约ID",show_maintext:"",BookData:[]}),uni.setStorage({key:"ACTID",data:t.actId}),t.Btn_SubmitForm()):(uni.showModal({title:"恢复失败",content:"此次义诊活动已结束",showCancel:!1}),uni.setStorage({key:"ACTID",data:""}),t.setData({actId:!1,show_title:"查询我的预约",show_inputholder:"请输入学工号或留空自动查询本账号记录"}))},fail:function(e){var i=e.errMsg;console.log(e.errMsg),e.errMsg.indexOf("cannot find document with")&&(i="未找到此次义诊活动"),uni.setStorage({key:"ACTID",data:""}),uni.showModal({title:"错误",content:i,showCancel:!1}),t.setData({actId:!1,show_title:"查询我的预约",show_inputholder:"请输入学工号或留空自动查询本账号记录"})}})):uni.setStorage({key:"ACTID",data:""})}})}}})},setCardFold:function(t){var e=t.currentTarget.dataset.id;this.setData((0,a.default)({},"cardFold."+e,!this.$data.cardFold[e]))},areReady:function(e,i,o){var a=this;e=r.AppSet;a.setData({AD:r.USERDATA.ad,show_apploading:!1}),g=e.opkey,v=e,p=t.database().collection(e.ColName2),console.log(g,JSON.parse(JSON.stringify(e)),!0),uni.hideLoading({success:function(t){}}),e.DefCount[r.openid]&&a.setData({show_defaultTime:e.DefCount[r.openid],show_forbidTime:l.getTimeLen(e.DefTime[r.openid])>(new Date).getTime()&&e.DefTime[r.openid]});a=this;this.input_id=g,this.Btn_SubmitForm(),uni.getStorage({key:"OPLOGIN",success:function(t){"object"==(0,n.default)(t.data)&&(uni.getStorage({key:"ISCLUBMEMBER",success:function(t){console.log(t),a.setData({isClubMem:t.data})},fail:function(t){(0,s.cbq)(p.where({"resolve.openid":r.openid}).count(),{success:function(t){console.log(t),t.total>0&&(a.setData({isClubMem:!0}),uni.setStorage({key:"ISCLUBMEMBER",data:!0}))}})}}),console.log(t.data),a.setData({OpLoginData:t.data}),r.OpData=t.data,a.RecoverAct())}})},isUmpty:function(t){return"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t?"":String(t).replace(/\n/g," ").replace(/,/g,"，")},ExportCsvResBuild:function(t){var e="_id,_openid,status,statusText,book.date,book.section,book.comkind,book.queskind,book.mobile,book.question,book.stuid,book.uploadtime,book.sectionText,hasSubscribe,ver,resolve.name,resolve.openid,resolve.starttime,resolve.stuid,resolve.endtime,resolve.question,resolve.result,comment.star,comment.text,comment.time,hasCal,cancelTime,defaultTime".split(","),i='"Tip: if you see garbled code, please use the system Notepad to open it, save it as UTF-8 format with BOM, and then open it again."\n'+e.join(",");console.log(t);var o=this.isUmpty;for(var n in t){var a=t[n];for(var s in i+="\n",e){var l=e[s].split("."),c=a;for(var r in l)if(c=c[l[r]],"undefined"==typeof c)break;"undefined"==typeof c?i+=",":i=i+o(c)+","}}return i},goPost:function(){uni.navigateTo({url:"/pages/postings/postingdetails?postid=留言板"})},VolcsvresultBuild:function(t,e){var i='"Tip: if you see garbled code, please use the system Notepad to open it, save it as UTF-8 format with BOM, and then open it again."\n姓名,学院,学号,志愿时长,活动名称,活动时间,活动地点,活动负责人,活动组织,活动简介,备注';console.log(t);var o=this.isUmpty;for(var n in t){0;var a=t[n];i+="\n",i=i+a.info.person.name+","+o(a.info.school)+","+a.info.person.stuid+","+String(a.applyTime)+"h,"+o(e.name)+","+o(a.info.time)+","+o(e.location)+","+o(e.person)+","+o(e.company)+","+o(e.intro)+","+o(a.info.tip)}return console.log(i),i},csvFileGenerate:function(t,e){var i=this;uni.hideLoading({success:function(t){}}),uni.showModal({showCancel:!1,title:"导出表单提示",content:'将导出用户为CSV格式到剪切板，需要自行创建CSV文件然后粘贴，如使用Excel打开后出现编码错误，请在粘贴到txt后保存为"带有 BOM 的 UTF-8"格式，可以通过Excel等软件打开。',success:function(o){var n;if(o.confirm)return n="vol"==t?i.VolcsvresultBuild(e.userRes,e.actInfo):i.ExportCsvResBuild(e),void uni.setClipboardData({data:n,success:function(){uni.showToast({title:"复制成功"})}})}})},csvUpload:function(e,i){uni.showLoading({mask:!0,title:"正在生成文件"}),t.uploadFile({cloudPath:"vol"==i?"VolApplyData/Applicaton_of_HITComputer110_Volunteering_Certification_"+c.globalData.getTime(!0,!0,!0)+".csv":"ExportData/DataBase_Export_HITComputer110_"+l.getTime(!0,!0,!0)+".csv",filePath:e,success:function(e){console.log(e.fileID),t.getTempFileURL({fileList:[{fileID:e.fileID,maxAge:3600}],success:function(t){uni.hideLoading({success:function(t){}}),console.log(t.fileList);var e=t.fileList[0].tempFileURL;uni.showModal({title:"导出成功",content:"已生成文件下载链接，有效期60分钟，请复制链接到浏览器进行下载。",confirmText:"复制链接",cancelText:"取消",success:function(t){t.confirm&&uni.setClipboardData({data:e})}})},fail:function(t){uni.hideLoading({success:function(t){}}),uni.showModal({title:"获取下载链接失败",content:t.errMsg,showCancel:!1})}})},fail:function(t){uni.hideLoading({success:function(t){}}),console.log(t),uni.showModal({title:"文件生成失败",content:t.errMsg,showCancel:!1})}})}}});e.default=m}).call(this,i("a9ff")["default"])},"7c7a":function(t,e,i){var o=i("24fb");e=o(!1),e.push([t.i,"/* mybook/mybook.wxss */.indexfronttext[data-v-9036281a]{float:right;width:50vw;height:40vw;overflow:auto;margin-top:15vw;margin-left:0;margin-bottom:0;margin-right:10px;font-weight:900}.title[data-v-9036281a]{font-size:%?45?%;display:flex;align-items:center;justify-content:center;margin-bottom:%?25?%;font-weight:800;white-space:pre-wrap}.text2[data-v-9036281a]{font-size:%?30?%;padding:%?35?% %?25?% 1vw %?25?%;white-space:pre-wrap;line-height:%?60?%;font-weight:800}.btn[data-v-9036281a]{position:relative;margin-top:%?35?%;display:block;width:184px;margin-left:auto;margin-right:auto;padding:8px 24px;box-sizing:border-box;font-weight:700;font-size:17px;text-align:center;text-decoration:none;color:#fff;line-height:1.41176471;border-radius:4px;overflow:hidden}",""]),t.exports=e},9524:function(t,e,i){"use strict";i.r(e);var o=i("1da6"),n=i("be9b");for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);i("519d");var s=i("f0c5"),l=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,"9036281a",null,!1,o["a"],void 0);e["default"]=l.exports},bbef:function(t,e,i){var o=i("7c7a");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var n=i("4f06").default;n("4bc0ef9c",o,!0,{sourceMap:!1,shadowMode:!1})},be9b:function(t,e,i){"use strict";i.r(e);var o=i("7765"),n=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=n.a},d3e5:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.ca=void 0,e.request=c,e.showFail=l;i("51b3"),i("460c");var o=getApp(),n=o.globalData,a=n.ENCRYPTO,s="加载";function l(t,e){"string"!=typeof e&&(e=s),uni.hideLoading(),uni.showModal({title:e+"失败",content:t,showCancel:!1})}function c(t){var e,i,o,c,r=t.title,u=t.tipShow,d=t.tipOption,p=t.tipActionCancel,h=t.tipActionSuccess,f=(t.packPublicKey,t.data),g=t.keyOption,v=t.optionUrl,m=t.urlPath,w=t.success,b=t.fail;if("boolean"!=typeof u&&(u=!0),"string"!=typeof r&&(r="加载"),s=r,console.log("开始请求",r,t),u){if(!d)return void console.error("使用tipShow请传入tipOption");if(e=d.WAIT,i=d.tipText,o=d.tipSubText,c=d.cancelText,!e)return void console.error("使用tipShow请传入tipOption.WAIT，请使用当前显示页面的WAITObj！");i||(i="正在"+r),o||(o="请稍后"),c||(c="取消")}var _={};u&&n.showWait(e,i,o,c,(function(t,e){if(t){if("function"==typeof h&&h(e))return;e()}else{if("function"==typeof _.abort&&_.abort(),"function"==typeof p&&p(e))return;e()}})),console.log("keyoption=",g);var y=a.cover.packData(f,!0,g),D="http://"+n.ServerUrl+"/"+n.AppServerName+"/"+m;console.log(m),v&&(D=m),console.log(D),_=uni.request({url:D,method:"POST",header:{"content-type":"application/json"},data:y,responseType:"json",sslVerify:!1,firstIpv4:!0,success:function(t){if(console.log("收到数据",t),200!=t.statusCode)return u&&n.hideWait(e,!1),void l("服务器错误："+t.data.error,r);var i=a.cover.unpackData(t.data),o=function(t){"boolean"!=typeof t&&(t=!0),u&&n.hideWait(e,t)};"function"==typeof w&&w(i,o)||o()},fail:function(t){console.log("请求失败",t);var i=function(){(u||"function"!=typeof b)&&l("错误："+t.errMsg,r),u&&n.hideWait(e,!1)};"function"==typeof b&&(u&&l("错误："+t.errMsg,r),b(t,i))||i()}})}var r=i("ffcd"),u=i("1818"),d={getPublicKey:r.ca.getPublicKey,getPublicSignKey:r.ca.getPublicSignKey,querySignValid:function(t,e,i){return uni.showLoading({title:"签名验证中"}),u.verifySign(t,e,this.getPublicSignKey())?(console.log(n.CAURL),c({tipShow:!1,title:"验证签名",optionUrl:!0,urlPath:n.CAURL+"queryB",keyOption:this.getPublicKey(),data:{certificate:e},success:function(e,o){if(uni.hideLoading(),e.status){if(1==e.data){var n=JSON.parse(t).data;i(n)}else i("");o(!0)}else o(!1),server.showFail(e.errMsg);return!0},fail:function(){uni.hideLoading(),i("")}}),!0):(uni.hideLoading(),!1)}};e.ca=d}}]);