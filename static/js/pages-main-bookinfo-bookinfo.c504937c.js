(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-main-bookinfo-bookinfo"],{4945:function(t,i,e){"use strict";(function(t){e("7a82");var a=e("4ea4").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=a(e("5530"));e("a9e3");var s=e("51b3"),o=e("7cc0"),l=e("a5fa"),r=(l.formatTime,e("460c")),c=null,v=getApp(),u=v.globalData,f=(u.ENCRYPTO,t.database()),d=(f.collection("ProgramSet"),f.collection("Users"),"@/pages/main/bookinfo/bookinfo?id="),p="",m=!1,h={data:function(){return{COLORTHEMECOMMON:u.COLORTHEMECOMMON,COLORTHEME:u.COLORTHEME,COLORTHEMESTYLE:u.COLORTHEMESTYLE,THEMEID:u.THEMEID,THEMETYPE:u.THEMETYPE,THEMELIST:u.THEMELIST,VERSION:u.VERSION,AD:u.AD,m:{r:function(t,i,e){if("string"!=typeof t)return t;if(e)return t;for(var a=t.substring(0,i),n=0;n<t.length-i;n++)a+="*";return a}},watcherError:!1,IconType:u.IconType,RepairModel:!1,showBookInfo:!1,canvasHidden:!1,QRimgPath:"",op_right:!1,repairop:!1,confirmToReceive:!1,RepairData:{question:"",result:""},CommentData:{stars:3,comment:""},CommentModel:!1,BookInfo:{statusText:"",comment:{star:0,text:"",time:""},book:{date:"",sectionText:"",stuid:"",stuname:"",mobile:"",comkind:!1,queskind:!1,question:"",uploadtime:""},_id:"",_openid:"",cancelTime:"",defaultTime:"",status:"",resolve:{starttime:"",endtime:"",question:"",result:""}},Tip:"",reTip:""}},onPullDownRefresh:function(t){r.isTimeLimit("预约信息",10,"刷新频率限制")?(this.setData({showBookInfo:!1}),this.Reflesh()):uni.stopPullDownRefresh({success:function(t){}})},onUnload:function(t){},onLoad:function(t){u.RefleshGlobalData(),uni.setNavigationBarColor({backgroundColor:u.COLORTHEME["--color-main"],frontColor:u.COLORTHEME["--color-navitext"]}),u.openid=u.USERDATA._openid,u.OpData=u.USERDATA,console.log(t),c=this,"string"==typeof t.id?(d="/pages/main/bookinfo/bookinfo?id="+t.id,console.log("DOCID",t.id),p=t.id,c.setData({op_right:"true"===t.op,repairop:"true"==t.reop}),u.ServerReady(c.Reflesh)):c.failLoad("预约不存在")},onShareAppMessage:function(){return{title:"哈工大电脑110义诊预约凭证",path:d}},methods:{editComment:function(t){"star"==t.currentTarget.dataset.id?this.setData({"CommentData.stars":Number(t.currentTarget.dataset.level)}):this.CommentData[t.currentTarget.dataset.id]=t.detail.value},editRepair:function(t){this.RepairData[t.currentTarget.dataset.id]=t.detail.value},repairBtn:function(t){console.log(t);var i=this,e=t.currentTarget.dataset.id;if("back"==e)uni.navigateBack({delta:0});else if("confirm"==e){if(u.openid==i.BookInfo._openid&&!u.debug)return void uni.showModal({title:"错误",content:"无法接自己创建的预约",showCancel:!1});uni.showLoading({title:"接单中",mask:!0});var a=(0,n.default)({},i.BookInfo);a.statusText="正在义诊中",a.resolve={name:u.OpData.name,openid:u.OpData._openid,stuid:u.OpData.stuid,starttime:v.globalData.getTime()},a.status=!1,delete a._openid,delete a._id,console.log(a),(0,s.cbq)(m.doc(p).update(a),{complete:function(t){uni.hideLoading({success:function(t){}})},fail:function(t){uni.showModal({showCancel:!1,title:"错误",content:t.errMsg})},success:function(t){uni.hideLoading({success:function(t){}}),uni.showToast({title:"接单成功"}),i.setData({confirmToReceive:!0}),i.Reflesh()}})}else if("cancel"==e)i.setData({RepairModel:!1});else if("show"==e)i.setData({RepairModel:!0,RepairData:i.RepairData});else if("save"==e){var o=function(t){i.setData({RepairData:i.RepairData,RepairModel:!1}),console.log(i.RepairData),"string"!=typeof i.RepairData.question&&(i.RepairData.question=""),"string"!=typeof i.RepairData.result&&(i.RepairData.result=""),(0,s.cbq)(m.doc(p).update({status:!1,statusText:"义诊已完成，待评价",resolve:{name:u.OpData.name,openid:u.OpData._openid,stuid:u.OpData.stuid,endtime:t,question:""==i.RepairData.question?"未填写":i.RepairData.question,result:""==i.RepairData.result?"未填写":i.RepairData.result}}),{success:function(t){console.log(t),i.Reflesh(),u.sendCommentMessage({start:i.BookInfo.resolve.starttime,end:r.getTime(),id:p,openid:i.BookInfo._openid})}})};if(r.getTime(!0,!1)!=i.BookInfo.resolve.starttime.split(" ")[0]){var l=r.getTimeLen(i.BookInfo.resolve.starttime);return l+=36e5,l=r.toTimeText(l,!0),void uni.showModal({title:"提示",content:"本次义诊时间异常，仅记录1小时义诊时长",success:function(t){t.confirm&&o(l)}})}o(r.getTime())}else"commSub"==e?(console.log(111),i.setData({CommentModel:!1,CommentData:this.CommentData}),"string"==typeof this.CommentData.comment&&""!=this.CommentData.comment||(this.CommentData.comment="未填写"),(0,s.cbq)(m.doc(p).update({status:!1,statusText:"义诊已完成",comment:{star:this.CommentData.stars,text:this.CommentData.comment,time:r.getTime()}}),{success:function(t){i.Reflesh()}})):"comcan"==e?i.setData({CommentModel:!1,CommentData:this.CommentData}):"comment"==e?i.setData({CommentModel:!0}):"shensu"==e&&uni.showModal({title:"功能待开放",showCancel:!1})},failLoad:function(t){uni.hideLoading({success:function(t){}}),uni.showModal({title:"错误",content:t,showCancel:!1,success:function(t){1!=getCurrentPages().length?uni.navigateBack({delta:0}):uni.reLaunch({url:"../index/index"})}})},cancelBook:function(t){var i=this,e=t.currentTarget.dataset.id;console.log(t),"cancel"==e?uni.showModal({title:"提示",content:"确认取消本次预约吗？取消后不可撤回。",showCancel:!0,success:function(t){t.confirm&&(0,s.cbq)(m.doc(p).update({status:!1,statusText:"预约已取消",cancelTime:r.getTime()}),{success:function(t){i.Reflesh()},fail:function(t){uni.showModal({showCancel:!1,title:"错误",content:"取消失败\n"+t.errMsg})}})}}):uni.showModal({title:"提示",content:"如果经过义诊员的检查，该预约不符合义诊条件，义诊员需要退回本次预约。确认退回本次预约吗？",showCancel:!0,success:function(t){t.confirm&&(0,s.cbq)(m.doc(p).update({status:!1,statusText:"预约已退回",resolve:{name:u.OpData.name,openid:u.OpData._openid,stuid:u.OpData.stuid,starttime:r.getTime(),endtime:r.getTime(),question:"不符合义诊规定",result:"退回预约"}}),{success:function(t){console.log(t),i.Reflesh()},fail:function(t){uni.showModal({showCancel:!1,title:"错误",content:"退回失败\n"+t.errMsg})}})}})},RefleshQR:function(){var t=u.setCanvasSize();this.createQrCode("book"+p,"mycanvas",t.w,t.h)},WatchError:function(){var t=this;(0,s.cbq)(m.doc(p).get(),{success:function(i){uni.hideLoading({success:function(t){}}),console.log(i),0!=i.data.length?(t.dealdata(i.data[0]),t.setData({watcherError:!0}),setTimeout((function(){t.RefleshQR()}),1e3)):t.failLoad("加载失败\n预约ID:"+p+"\n错误信息："+i.errMsg)},fail:function(i){t.failLoad("加载失败\n预约ID:"+p+"\n错误信息："+i.errMsg)},complete:function(t){uni.stopPullDownRefresh({success:function(t){}})}})},dealdata:function(t){console.log(u.openid,t),"失败"!=t?u.USERDATA._openid==t._openid||u.USERDATA.uid==t._openid||this.op_right||this.repairop?(console.log(this.confirmToReceive,t),"预约已生效"==t.statusText&&r.getTimeLen(r.getTime(!0,!1))<v.globalData.getTimeLen(t.book.date)&&(t.statusText="预约待生效"),this.setData({showBookInfo:!0,BookInfo:t,Tip:u.AppSet.Tip[t.statusText],reTip:"undefined"==typeof u.AppSet.Tipre[t.statusText]?u.AppSet.Tip[t.statusText]:u.AppSet.Tipre[t.statusText],confirmToReceive:!!t.resolve&&t.resolve.openid==u.openid})):this.failLoad("您无权限查看此预约"):this.failLoad("预约不存在\n预约ID:"+p)},Reflesh:function(){uni.showLoading({title:"加载中",mask:!0,fail:console.error}),console.log(p),m=t.database().collection(u.AppSet.ColName2),this.WatchError()},createQrCode:function(t,i,e,a){o.api.draw(t,i,e,a,void 0,this.canvasToTempImage)},canvasToTempImage:function(){var t=this;uni.canvasToTempFilePath({canvasId:"mycanvas",success:function(i){var e=i.tempFilePath;t.setData({QRimgPath:e})},fail:function(t){console.log(t)}})},previewImg:function(t){var i=this.QRimgPath;uni.previewImage({current:i,urls:[i]})},share:function(){uni.showModal({title:"提示",content:"不支持在非微信小程序中发送预约凭证，是否复制预约ID？",success:function(t){t.confirm&&uni.setClipboardData({data:p})}})}}};i.default=h}).call(this,e("a9ff")["default"])},"4c13":function(t,i,e){var a=e("24fb");i=a(!1),i.push([t.i,".FORMlineright[data-v-c57716da]{max-width:%?525?%;overflow:scroll}.FORMtextline[data-v-c57716da],\n.FORMheadline[data-v-c57716da]{font-weight:800}.FORMtextline[data-v-c57716da]{font-size:%?35?%}uni-view[data-v-c57716da],\nuni-text[data-v-c57716da]{-webkit-user-select:text;user-select:text}.container[data-v-c57716da]{display:flex;align-items:center;justify-content:center;width:100%;height:100%}.container uni-image[data-v-c57716da]{width:%?686?%;height:%?686?%;background-color:#f9f9f9}.canvas-box[data-v-c57716da]{position:fixed;top:%?999999?%;left:0}.infobtnleft[data-v-c57716da]{width:%?280?%}.infobtnright[data-v-c57716da]{width:%?350?%}.request-form-btnline[data-v-c57716da]{display:flex;margin-top:%?40?%;padding:0;justify-content:space-between;align-items:center}uni-view[data-v-c57716da],\nuni-text[data-v-c57716da]{font-size:%?30?%}.MODELLINE[data-v-c57716da]{width:90%}.MODELTITLEh[data-v-c57716da]{font-size:%?40?%}.FORMlineleft[data-v-c57716da]{min-width:%?150?%}",""]),t.exports=i},"7cc0":function(t,i,e){e("fb6a"),function(){var i,e,a,n,s,o,l=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],r=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177],c=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],v=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],u=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],f=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],d=[],p=[],m=[],h=[],w=[],M=2;function R(t,i){var e;t>i&&(e=t,t=i,i=e),e=i,e*=i,e+=i,e>>=1,e+=t,h[e]=1}function C(t,i){var a;for(m[t+e*i]=1,a=-2;a<2;a++)m[t+a+e*(i-2)]=1,m[t-2+e*(i+a+1)]=1,m[t+2+e*(i+a)]=1,m[t+a+1+e*(i+2)]=1;for(a=0;a<2;a++)R(t-1,i+a),R(t+1,i-a),R(t-a,i-1),R(t+a,i+1)}function O(t){while(t>=255)t-=255,t=(t>>8)+(255&t);return t}var g=[];function _(t,i,e,a){var n,s,o;for(n=0;n<a;n++)d[e+n]=0;for(n=0;n<i;n++){if(o=u[d[t+n]^d[e]],255!=o)for(s=1;s<a;s++)d[e+s-1]=d[e+s]^f[O(o+g[a-s])];else for(s=e;s<e+a;s++)d[s]=d[s+1];d[e+a-1]=255==o?0:f[O(o+g[0])]}}function k(t,i){var e;return t>i&&(e=t,t=i,i=e),e=i,e+=i*i,e>>=1,e+=t,h[e]}function F(t){var i,a,n,s;switch(t){case 0:for(a=0;a<e;a++)for(i=0;i<e;i++)i+a&1||k(i,a)||(m[i+a*e]^=1);break;case 1:for(a=0;a<e;a++)for(i=0;i<e;i++)1&a||k(i,a)||(m[i+a*e]^=1);break;case 2:for(a=0;a<e;a++)for(n=0,i=0;i<e;i++,n++)3==n&&(n=0),n||k(i,a)||(m[i+a*e]^=1);break;case 3:for(s=0,a=0;a<e;a++,s++)for(3==s&&(s=0),n=s,i=0;i<e;i++,n++)3==n&&(n=0),n||k(i,a)||(m[i+a*e]^=1);break;case 4:for(a=0;a<e;a++)for(n=0,s=a>>1&1,i=0;i<e;i++,n++)3==n&&(n=0,s=!s),s||k(i,a)||(m[i+a*e]^=1);break;case 5:for(s=0,a=0;a<e;a++,s++)for(3==s&&(s=0),n=0,i=0;i<e;i++,n++)3==n&&(n=0),(i&a&1)+!(!n|!s)||k(i,a)||(m[i+a*e]^=1);break;case 6:for(s=0,a=0;a<e;a++,s++)for(3==s&&(s=0),n=0,i=0;i<e;i++,n++)3==n&&(n=0),(i&a&1)+(n&&n==s)&1||k(i,a)||(m[i+a*e]^=1);break;case 7:for(s=0,a=0;a<e;a++,s++)for(3==s&&(s=0),n=0,i=0;i<e;i++,n++)3==n&&(n=0),(n&&n==s)+(i+a&1)&1||k(i,a)||(m[i+a*e]^=1);break}}function T(t){var i,e=0;for(i=0;i<=t;i++)w[i]>=5&&(e+=3+w[i]-5);for(i=3;i<t-1;i+=2)w[i-2]==w[i+2]&&w[i+2]==w[i-1]&&w[i-1]==w[i+1]&&3*w[i-1]==w[i]&&(0==w[i-3]||i+3>t||3*w[i-3]>=4*w[i]||3*w[i+3]>=4*w[i])&&(e+=40);return e}function b(){var t,i,a,n,s,o=0,l=0;for(i=0;i<e-1;i++)for(t=0;t<e-1;t++)(m[t+e*i]&&m[t+1+e*i]&&m[t+e*(i+1)]&&m[t+1+e*(i+1)]||!(m[t+e*i]||m[t+1+e*i]||m[t+e*(i+1)]||m[t+1+e*(i+1)]))&&(o+=3);for(i=0;i<e;i++){for(w[0]=0,a=n=t=0;t<e;t++)(s=m[t+e*i])==n?w[a]++:w[++a]=1,n=s,l+=n?1:-1;o+=T(a)}l<0&&(l=-l);var r=l,c=0;r+=r<<2,r<<=1;while(r>e*e)r-=e*e,c++;for(o+=10*c,t=0;t<e;t++){for(w[0]=0,a=n=i=0;i<e;i++)(s=m[t+e*i])==n?w[a]++:w[++a]=1,n=s;o+=T(a)}return o}var x=null,D={get ecclevel(){return M},set ecclevel(t){M=t},get size(){return _size},set size(t){_size=t},get canvas(){return x},set canvas(t){x=t},getFrame:function(t){return function(t){var w,T,x,D,E,I,y,B;D=t.length,i=0;do{if(i++,x=4*(M-1)+16*(i-1),a=v[x++],n=v[x++],s=v[x++],o=v[x],x=s*(a+n)+n-3+(i<=9),D<=x)break}while(i<40);for(e=17+4*i,E=s+(s+o)*(a+n)+n,D=0;D<E;D++)p[D]=0;for(d=t.slice(0),D=0;D<e*e;D++)m[D]=0;for(D=0;D<(e*(e+1)+1)/2;D++)h[D]=0;for(D=0;D<3;D++){for(x=0,T=0,1==D&&(x=e-7),2==D&&(T=e-7),m[T+3+e*(x+3)]=1,w=0;w<6;w++)m[T+w+e*x]=1,m[T+e*(x+w+1)]=1,m[T+6+e*(x+w)]=1,m[T+w+1+e*(x+6)]=1;for(w=1;w<5;w++)R(T+w,x+1),R(T+1,x+w+1),R(T+5,x+w),R(T+w+1,x+5);for(w=2;w<4;w++)m[T+w+e*(x+2)]=1,m[T+2+e*(x+w+1)]=1,m[T+4+e*(x+w)]=1,m[T+w+1+e*(x+4)]=1}if(i>1)for(D=l[i],T=e-7;;){w=e-7;while(w>D-3){if(C(w,T),w<D)break;w-=D}if(T<=D+9)break;T-=D,C(6,T),C(T,6)}for(m[8+e*(e-8)]=1,T=0;T<7;T++)R(7,T),R(e-8,T),R(7,T+e-7);for(w=0;w<8;w++)R(w,7),R(w+e-8,7),R(w,e-8);for(w=0;w<9;w++)R(w,8);for(w=0;w<8;w++)R(w+e-8,8),R(8,w);for(T=0;T<7;T++)R(8,T+e-7);for(w=0;w<e-14;w++)1&w?(R(8+w,6),R(6,8+w)):(m[8+w+6*e]=1,m[6+e*(8+w)]=1);if(i>6)for(D=r[i-7],x=17,w=0;w<6;w++)for(T=0;T<3;T++,x--)1&(x>11?i>>x-12:D>>x)?(m[5-w+e*(2-T+e-11)]=1,m[2-T+e-11+e*(5-w)]=1):(R(5-w,2-T+e-11),R(2-T+e-11,5-w));for(T=0;T<e;T++)for(w=0;w<=T;w++)m[w+e*T]&&R(w,T);for(E=d.length,I=0;I<E;I++)p[I]=d.charCodeAt(I);if(d=p.slice(0),w=s*(a+n)+n,E>=w-2&&(E=w-2,i>9&&E--),I=E,i>9){d[I+2]=0,d[I+3]=0;while(I--)D=d[I],d[I+3]|=255&D<<4,d[I+2]=D>>4;d[2]|=255&E<<4,d[1]=E>>4,d[0]=64|E>>12}else{d[I+1]=0,d[I+2]=0;while(I--)D=d[I],d[I+2]|=255&D<<4,d[I+1]=D>>4;d[1]|=255&E<<4,d[0]=64|E>>4}I=E+3-(i<10);while(I<w)d[I++]=236,d[I++]=17;for(g[0]=1,I=0;I<o;I++){for(g[I+1]=1,y=I;y>0;y--)g[y]=g[y]?g[y-1]^f[O(u[g[y]]+I)]:g[y-1];g[0]=f[O(u[g[0]]+I)]}for(I=0;I<=o;I++)g[I]=u[g[I]];for(x=w,T=0,I=0;I<a;I++)_(T,s,x,o),T+=s,x+=o;for(I=0;I<n;I++)_(T,s+1,x,o),T+=s+1,x+=o;for(T=0,I=0;I<s;I++){for(y=0;y<a;y++)p[T++]=d[I+y*s];for(y=0;y<n;y++)p[T++]=d[a*s+I+y*(s+1)]}for(y=0;y<n;y++)p[T++]=d[a*s+I+y*(s+1)];for(I=0;I<o;I++)for(y=0;y<a+n;y++)p[T++]=d[w+I+y*o];for(d=p,w=T=e-1,x=E=1,B=(s+o)*(a+n)+n,I=0;I<B;I++)for(D=d[I],y=0;y<8;y++,D<<=1){128&D&&(m[w+e*T]=1);do{E?w--:(w++,x?0!=T?T--:(w-=2,x=!x,6==w&&(w--,T=9)):T!=e-1?T++:(w-=2,x=!x,6==w&&(w--,T-=8))),E=!E}while(k(w,T))}for(d=m.slice(0),D=0,T=3e4,x=0;x<8;x++){if(F(x),w=b(),w<T&&(T=w,D=x),7==D)break;m=d.slice(0)}for(D!=x&&F(D),T=c[D+(M-1<<3)],x=0;x<8;x++,T>>=1)1&T&&(m[e-1-x+8*e]=1,x<6?m[8+e*x]=1:m[8+e*(x+1)]=1);for(x=0;x<7;x++,T>>=1)1&T&&(m[8+e*(e-7+x)]=1,x?m[6-x+8*e]=1:m[7+8*e]=1);return m}(t)},utf16to8:function(t){var i,e,a,n;for(i="",a=t.length,e=0;e<a;e++)n=t.charCodeAt(e),n>=1&&n<=127?i+=t.charAt(e):n>2047?(i+=String.fromCharCode(224|n>>12&15),i+=String.fromCharCode(128|n>>6&63),i+=String.fromCharCode(128|n>>0&63)):(i+=String.fromCharCode(192|n>>6&31),i+=String.fromCharCode(128|n>>0&63));return i},draw:function(t,i,a,n,s){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},l=arguments.length>6?arguments[6]:void 0,r=this;if(M=l||M,i=i||x,i){var c=Math.min(a,n);t=r.utf16to8(t);var v=r.getFrame(t),u=uni.createCanvasContext(i,s),f=Math.round(c/(e+8)),d=f*(e+8),p=Math.floor((c-d)/2);c=d,u.setFillStyle("#ffffff"),u.fillRect(0,0,a,a),u.setFillStyle("#000000");for(var m=0;m<e;m++)for(var h=0;h<e;h++)v[h*e+m]&&u.fillRect(f*(4+m)+p,f*(4+h)+p,f,f);u.draw(!1,(function(){o()})),setTimeout((function(){o()}),1e3)}else console.warn("No canvas provided to draw QR code in!")}};t.exports={api:D}}()},a436:function(t,i,e){"use strict";e.r(i);var a=e("4945"),n=e.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){e.d(i,t,(function(){return a[t]}))}(s);i["default"]=n.a},d081:function(t,i,e){var a=e("4c13");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=e("4f06").default;n("1da799bc",a,!0,{sourceMap:!1,shadowMode:!1})},f40d:function(t,i,e){"use strict";var a=e("d081"),n=e.n(a);n.a},f884:function(t,i,e){"use strict";e.d(i,"b",(function(){return a})),e.d(i,"c",(function(){return n})),e.d(i,"a",(function(){}));var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{style:t.COLORTHEMECOMMON},[e("v-uni-view",{staticClass:"pagecontent",style:t.COLORTHEMESTYLE},[t.CommentModel?e("v-uni-view",{staticClass:"MODEL"},[e("v-uni-view",{staticClass:"MODELchild"},[e("v-uni-view",{staticClass:"MODELtitle MODELTITLEh"},[t._v("义诊评价")]),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("评分")]),e("v-uni-view",{staticClass:"FORMlineright"},t._l([1,2,3,4,5],(function(i,a){return e("v-uni-view",{key:a,attrs:{"data-id":"star","data-level":i},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.editComment.apply(void 0,arguments)}}},[e("v-uni-image",{staticStyle:{width:"45rpx",height:"45rpx"},attrs:{src:"/static/images/star"+(i>t.CommentData.stars?"E":"L")+".png"}})],1)})),1)],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("评价")]),e("v-uni-view",{staticClass:"FORMlineright"},[e("v-uni-input",{staticClass:"MODELinput",staticStyle:{width:"375rpx"},attrs:{placeholder:"请输入评价（可空）","placeholder-class":"inputboxplaceholder",maxlength:"-1","data-id":"comment",value:t.CommentData.comment},on:{input:function(i){arguments[0]=i=t.$handleEvent(i),t.editComment.apply(void 0,arguments)}}})],1)],1),e("v-uni-view",{staticClass:"MODELrow"},[e("v-uni-button",{staticClass:"MODELbtn",attrs:{"data-id":"commSub"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.repairBtn.apply(void 0,arguments)}}},[t._v("提交评价")]),e("v-uni-button",{staticClass:"MODELbtn",attrs:{normal:!0,"data-id":"comcan"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.repairBtn.apply(void 0,arguments)}}},[t._v("取消")])],1)],1)],1):t._e(),t.RepairModel?e("v-uni-view",{staticClass:"MODEL"},[e("v-uni-view",{staticClass:"MODELchild"},[e("v-uni-view",{staticClass:"MODELtitle MODELTITLEh"},[t._v("完成义诊")]),e("v-uni-view",{staticClass:"FORMitem FORMline MODELLINE"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("问题诊断")]),e("v-uni-view",{staticClass:"FORMlineright"},[e("v-uni-input",{staticClass:"MODELinput",staticStyle:{width:"350rpx"},attrs:{placeholder:"请输入问题诊断（可空）","placeholder-class":"inputboxplaceholder",maxlength:"-1","data-id":"question",value:t.RepairData.question,"auto-focus":!0},on:{input:function(i){arguments[0]=i=t.$handleEvent(i),t.editRepair.apply(void 0,arguments)}}})],1)],1),e("v-uni-view",{staticClass:"FORMitem FORMline MODELLINE"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("处理结果")]),e("v-uni-view",{staticClass:"FORMlineright"},[e("v-uni-input",{staticClass:"MODELinput",staticStyle:{width:"350rpx"},attrs:{placeholder:"请输入处理结果（可空）","placeholder-class":"inputboxplaceholder",maxlength:"-1","data-id":"result",value:t.RepairData.result},on:{input:function(i){arguments[0]=i=t.$handleEvent(i),t.editRepair.apply(void 0,arguments)}}})],1)],1),e("v-uni-view",{staticClass:"MODELrow"},[e("v-uni-button",{staticClass:"MODELbtn",attrs:{"data-id":"save"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.repairBtn.apply(void 0,arguments)}}},[t._v("完成义诊")]),e("v-uni-button",{staticClass:"MODELbtn",attrs:{normal:!0,"data-id":"cancel"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.repairBtn.apply(void 0,arguments)}}},[t._v("取消")])],1)],1)],1):t._e(),t.watcherError?e("v-uni-view",{staticClass:"FORMheadline",staticStyle:{"background-color":"var(--color-blk-back)",padding:"10rpx 30rpx",width:"690rpx"}},[e("v-uni-icon",{staticClass:"icon-small",staticStyle:{width:"60rpx",height:"60rpx"},attrs:{type:"warn",size:"60rpx",color:"var(--color-btn-false)"}}),e("v-uni-view",{staticStyle:{"margin-left":"15rpx","font-weight":"300","font-size":"30rpx",color:"var(--color-text)"}},[t._v("服务器错误，需要手动下拉刷新状态")])],1):t._e(),e("v-uni-view",{staticStyle:{padding:"0 30rpx",width:"690rpx"}},[t.showBookInfo?e("v-uni-view",{staticClass:"FORM"},[e("v-uni-view",{staticStyle:{display:"flex","justify-content":"flex-start","align-items":"center",margin:"30rpx 0"}},[e("v-uni-icon",{attrs:{type:t.IconType[t.BookInfo.statusText]?t.IconType[t.BookInfo.statusText]:"success",size:"120rpx",color:"var(--color-main)"}}),e("v-uni-view",{staticStyle:{"margin-left":"30rpx","font-weight":"700","font-size":"50rpx"}},[t._v(t._s(t.BookInfo.statusText))])],1),t.repairop?e("v-uni-view",{staticStyle:{padding:"0 30rpx 0 50rpx"}},[e("v-uni-view",{staticClass:"FORMtext",staticStyle:{"font-size":"30rpx"}},[t._v(t._s(t.reTip))])],1):e("v-uni-view",{staticStyle:{padding:"0 30rpx 0 50rpx"}},[e("v-uni-view",{staticClass:"FORMtext",staticStyle:{"font-size":"30rpx"}},[t._v(t._s(t.Tip))])],1),"义诊已完成，待评价"==t.BookInfo.statusText?e("v-uni-view",{staticClass:"request-form-btnline"},[t.repairop||t.op_right?t._e():[e("v-uni-button",{staticClass:"infobtnleft",attrs:{normal:!0,"data-id":"shensu"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.repairBtn.apply(void 0,arguments)}}},[t._v("申诉")]),e("v-uni-button",{staticClass:"infobtnright",attrs:{"data-id":"comment"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.repairBtn.apply(void 0,arguments)}}},[t._v("评价")])]],2):t._e(),"正在义诊中"==t.BookInfo.statusText?e("v-uni-view",{staticClass:"request-form-btnline"},[t.repairop&&t.confirmToReceive||t.op_right?[e("v-uni-button",{staticClass:"infobtnleft",attrs:{normal:!0,"data-id":"back"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.repairBtn.apply(void 0,arguments)}}},[t._v("返回")]),e("v-uni-button",{staticClass:"infobtnright",attrs:{"data-id":"show"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.repairBtn.apply(void 0,arguments)}}},[t._v("完成义诊")])]:t._e()],2):t._e(),"预约已生效"==t.BookInfo.statusText?[t.repairop&&!t.confirmToReceive?e("v-uni-view",{staticClass:"request-form-btnline"},[e("v-uni-button",{staticClass:"infobtnleft",attrs:{normal:!0,"data-id":"back"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.cancelBook.apply(void 0,arguments)}}},[t._v("退回预约")]),e("v-uni-button",{staticClass:"infobtnright",attrs:{"data-id":"confirm"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.repairBtn.apply(void 0,arguments)}}},[t._v("确认接单")])],1):t._e()]:t._e(),"预约待生效"==t.BookInfo.statusText||"预约已生效"==t.BookInfo.statusText?[!t.repairop||t.op_right?e("v-uni-view",{staticClass:"request-form-btnline"},[e("v-uni-button",{staticClass:"infobtnleft",attrs:{normal:!0,"data-id":"cancel"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.cancelBook.apply(void 0,arguments)}}},[t._v("取消预约")]),e("v-uni-button",{staticClass:"infobtnright",attrs:{"open-type":"share"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.share.apply(void 0,arguments)}}},[t._v("保存预约凭证")])],1):t._e()]:t._e(),"义诊已完成"==t.BookInfo.statusText?[e("v-uni-view",{staticClass:"FORMtextline"},[e("v-uni-view",{staticStyle:{margin:"30rpx 0 7.5rpx 0"}},[t._v("评价信息")])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("评分")]),e("v-uni-view",{staticClass:"FORMlineright"},t._l([1,2,3,4,5],(function(i,a){return e("v-uni-view",{key:a,attrs:{"data-id":"star","data-level":i}},[e("v-uni-image",{staticStyle:{width:"45rpx",height:"45rpx"},attrs:{src:"/static/images/star"+(i>t.BookInfo.comment.star?"E":"L")+".png"}})],1)})),1)],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("评价")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.comment.text))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("评价时间")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.comment.time))])],1)]:t._e()],2):t._e()],1),e("v-uni-view",{staticClass:"con",staticStyle:{"padding-top":"0",width:"690rpx"}},[t.showBookInfo?e("v-uni-view",{staticClass:"FORM"},[e("v-uni-view",{staticClass:"FORMtextline"},[e("v-uni-view",{staticStyle:{margin:"30rpx 0 7.5rpx 0"}},[t._v("预约信息")])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("预约日期")]),e("v-uni-view",{staticClass:"FORMlineright",staticStyle:{"font-weight":"800"}},[t._v(t._s("2000-01-01"==t.BookInfo.book.date?"临时预约":t.BookInfo.book.date)+t._s("请您与义诊员协商"==t.BookInfo.book.sectionText?" ( 临时预约 )":""))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("预约时段")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.book.sectionText))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("预约ID")]),e("v-uni-view",{staticClass:"FORMlineright",staticStyle:{"word-break":"normal"}},[t._v(t._s(t.BookInfo._id))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("用户ID")]),e("v-uni-view",{staticClass:"FORMlineright",staticStyle:{"word-break":"normal"}},[t._v(t._s(t.BookInfo._openid))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("学工号")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.book.stuid))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("姓名")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.book.stuname))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("手机号")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.book.mobile))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("电脑型号")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.book.comkind?t.BookInfo.book.comkind:"暂无"))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("问题类型")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.book.queskind?t.BookInfo.book.queskind:"暂无"))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("电脑问题")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.book.question))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("预约时间")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.book.uploadtime))])],1),"预约已取消"==t.BookInfo.statusText?e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("取消时间")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.cancelTime))])],1):t._e(),e("v-uni-view",{staticClass:"FORMtextline"},[e("v-uni-view",{staticStyle:{margin:"30rpx 0 7.5rpx 0"}},[t._v("义诊信息")])],1),"已违约"==t.BookInfo.statusText?[e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("违约时间")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.defaultTime))])],1)]:["旧版记录无详情"==t.BookInfo.statusText||"预约已取消"==t.BookInfo.statusText||t.BookInfo.status||"义诊已取消"==t.BookInfo.statusText?["旧版记录无详情"!=t.BookInfo.statusText?e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("义诊状态")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v("未进行")])],1):e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("义诊状态")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v("旧版记录无详情")])],1)]:[e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("义诊员")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.m.r(t.BookInfo.resolve.name,1,t.op_right||t.repairop)))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft",staticStyle:{"word-break":"normal"}},[t._v("义诊员ID")]),e("v-uni-view",{staticClass:"FORMlineright",staticStyle:{"word-break":"normal"}},[t._v(t._s(t.m.r(t.BookInfo.resolve.openid,16,t.op_right||t.repairop)))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("义诊员学号")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.m.r(t.BookInfo.resolve.stuid,5,t.op_right||t.repairop)))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("开始时间")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.resolve.starttime))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("结束时间")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.resolve.endtime))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("诊断结果")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.resolve.question))])],1),e("v-uni-view",{staticClass:"FORMitem FORMline"},[e("v-uni-view",{staticClass:"FORMlineleft"},[t._v("义诊结果")]),e("v-uni-view",{staticClass:"FORMlineright"},[t._v(t._s(t.BookInfo.resolve.result))])],1)],"义诊已完成，待评价"!=t.BookInfo.statusText&&"义诊已完成"!=t.BookInfo.statusText&&"预约已取消"!=t.BookInfo.statusText?e("v-uni-view",[e("v-uni-view",{staticClass:"container",staticStyle:{"margin-top":"50rpx"}},[e("v-uni-image",{attrs:{mode:"scaleToFill",src:t.QRimgPath},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.previewImg.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"canvas-box"},[t.canvasHidden?t._e():e("v-uni-canvas",{staticClass:"QRcanvas",attrs:{"canvas-id":"mycanvas"}})],1),e("v-uni-view",{staticClass:"FORMitem FORMline",staticStyle:{padding:"0","justify-content":"center","margin-top":"30rpx"}},[e("v-uni-button",{staticStyle:{width:"700rpx"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.RefleshQR.apply(void 0,arguments)}}},[t._v("重绘二维码")])],1)],1):t._e()]],2):t._e()],1)],1)],1)},n=[]},f906:function(t,i,e){"use strict";e.r(i);var a=e("f884"),n=e("a436");for(var s in n)["default"].indexOf(s)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(s);e("f40d");var o=e("f0c5"),l=Object(o["a"])(n["default"],a["b"],a["c"],!1,null,"c57716da",null,!1,a["a"],void 0);i["default"]=l.exports}}]);